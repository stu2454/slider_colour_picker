<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Colour Picker Slider</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f5f5f5;
        }

        .color-picker-section {
            display: flex;
            flex-direction: column;
            align-items: center; /* Center text and bar */
            gap: 5px;
            position: relative;
            height: 80%;
            margin-right: 1%; /* Move closer to the slider to half the previous distance */
        }

        .color-picker-bar {
            height: 100%;
            width: 50px;
            border: 2px solid #ccc;
            cursor: pointer;
            position: relative;
            background: linear-gradient(to bottom, red, orange, yellow, green, blue, indigo, violet);
        }

        .slider-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            width: 25%;
            position: relative;
        }

        .slider {
            -webkit-appearance: none;
            appearance: none;
            width: 80%;
            height: 20px;
            border-radius: 9px;
            background: linear-gradient(to right, var(--dark-color) 0%, var(--light-color) 100%);
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--thumb-color);
            border: 3px solid #f5f5f5;
            cursor: pointer;
        }

        .value-box {
            font-weight: bold;
            text-align: center;
            width: 60px;
        }

        .select-button {
            padding: 10px 20px;
            font-size: 16px;
            color: white;
            background-color: #007BFF;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            position: absolute;
            top: 80px; /* Same vertical position as slider */
            right: -110px; /* Position to the right of the slider */
        }

        .select-button:hover {
            background-color: #0056b3;
        }

        p {
            font-family: Arial, sans-serif; /* Match font with other text */
            font-size: 18px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Colour Picker Section -->
    <div class="color-picker-section">
        <p>Click on a colour and slide the slider</p>
        <div class="color-picker-bar" onmousemove="updateThumbColor(event)" onclick="selectColor(event)"></div>
    </div>

    <!-- Slider Section -->
    <div class="slider-container">
        <h2>Selected Colour Slider</h2>
        <input type="range" class="slider" min="0" max="100" value="50" style="--dark-color: #888; --light-color: #ccc; --thumb-color: #888;" oninput="updateSlider(this)">
        <div class="value-box" id="slider-value">50</div>
        <button class="select-button" onclick="confirmSelection()">Select</button>
    </div>

    <script>
        function getColorAtCursor(y, element) {
            const height = element.offsetHeight;
            const relativeY = Math.max(0, Math.min(y / height, 1));
            const gradientColors = [
                [255, 0, 0],    // Red
                [255, 165, 0],  // Orange
                [255, 255, 0],  // Yellow
                [0, 128, 0],    // Green
                [0, 0, 255],    // Blue
                [75, 0, 130],   // Indigo
                [238, 130, 238] // Violet
            ];

            const stops = gradientColors.length - 1;
            const stopIndex = Math.floor(relativeY * stops);
            const color1 = gradientColors[stopIndex];
            const color2 = gradientColors[Math.min(stopIndex + 1, stops)];
            const blend = (relativeY * stops) - stopIndex;

            const r = Math.round(color1[0] + (color2[0] - color1[0]) * blend);
            const g = Math.round(color1[1] + (color2[1] - color1[1]) * blend);
            const b = Math.round(color1[2] + (color2[2] - color1[2]) * blend);

            return `rgb(${r}, ${g}, ${b})`;
        }

        function rgbToHsl(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0; // achromatic
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }

            return [h * 360, s * 100, l * 100];
        }

        function hslToRgb(h, s, l) {
            h /= 360; s /= 100; l /= 100;
            let r, g, b;

            if (s === 0) {
                r = g = b = l; // achromatic
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1 / 6) return p + (q - p) * 6 * t;
                    if (t < 1 / 2) return q;
                    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
                    return p;
                };

                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1 / 3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1 / 3);
            }

            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }

        function updateThumbColor(event) {
            const rect = event.target.getBoundingClientRect();
            const y = event.clientY - rect.top;
            const color = getColorAtCursor(y, event.target);

            // Update the slider thumb color dynamically
            const slider = document.querySelector('.slider');
            slider.style.setProperty('--thumb-color', color);
        }

        function selectColor(event) {
            const rect = event.target.getBoundingClientRect();
            const y = event.clientY - rect.top;
            const color = getColorAtCursor(y, event.target);

            // Convert RGB to HSL and lighten the L value
            const [r, g, b] = color.match(/\d+/g).map(Number);
            const [h, s, l] = rgbToHsl(r, g, b);
            const lightColor = hslToRgb(h, s, Math.min(l + 30, 100));

            // Update slider colors
            const slider = document.querySelector('.slider');
            slider.style.setProperty('--dark-color', color);
            slider.style.setProperty('--light-color', `rgb(${lightColor[0]}, ${lightColor[1]}, ${lightColor[2]})`);

            // Immediately update slider background
            updateSlider(slider);
        }

        function updateSlider(slider) {
            const percentage = slider.value;
            const darkColor = getComputedStyle(slider).getPropertyValue('--dark-color');
            const lightColor = getComputedStyle(slider).getPropertyValue('--light-color');
            slider.style.background = `linear-gradient(to right, ${darkColor} ${percentage}%, ${lightColor} ${percentage}%)`;
            document.getElementById('slider-value').innerText = slider.value;
        }

        function confirmSelection() {
            alert("Colour selection confirmed!");
        }
    </script>
</body>
</html>

